#!/bin/bash
set -e

case "$1" in
    remove|upgrade|deconfigure)
        echo "Stopping TalkType daemon for all users..."

        # Try to stop user services (best effort)
        for user_home in /home/*; do
            if [ -d "$user_home" ]; then
                username=$(basename "$user_home")
                sudo -u "$username" XDG_RUNTIME_DIR=/run/user/$(id -u "$username") \
                    systemctl --user stop talktype 2>/dev/null || true
            fi
        done
        ;;

    failed-upgrade)
        ;;

    *)
        echo "prerm called with unknown argument \`$1'" >&2
        exit 1
        ;;
esac

#DEBHELPER#

exit 0
